<?php

function internet_archive_thumb_from_file_url($url) {
  if ($item = internet_archive_item_from_file_url($url)) {
    $pathinfo = pathinfo($url);
    if (!empty($pathinfo['filename'])) {
      $filename = $pathinfo['filename'] . '_000001.jpg';

      $link = 'http://www.archive.org/download/';
      $link .= $item .'/'. $item .'.thumbs/';
      $link .= $filename;

      return $link;
    }
  }

  return false;
}

function internet_archive_item_from_file_url($url) {
  if (strpos($url, 'archive.org') !== false && strpos($url, 'download') !== false) {
    $urlinfo = parse_url($url);
    if (!empty($urlinfo['path'])) {
      $parts = explode('/', $urlinfo['path']);
      if (!empty($parts[2])) {
        return $parts[2];
      }
    }
  }

  return false;
}
